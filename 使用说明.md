# GitHub 项目信息爬取工具使用说明

## 概述

GitHub 项目信息爬取工具是一个简单实用的命令行工具，可以帮助您快速获取 GitHub 仓库的基本信息，包括项目名称、描述、Star 数量、Fork 数量等，并将这些信息保存到 Excel 文件中，便于管理和查阅。

## 功能特点

- 一键爬取 GitHub 仓库信息
- 自动保存到 Excel 文件
- 支持批量刷新已爬取的仓库信息
- 查看已爬取的仓库列表及项目总数
- 删除指定仓库的信息
- 智能识别已存在的仓库，避免重复记录
- 交互式循环模式，可连续操作
- 强健的错误处理，包括文件权限和网络问题

## 安装步骤

1. 确保您的系统已安装 Python 3.6 或更高版本
2. 安装必要的依赖包：

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 爬取单个仓库信息

#### 命令行方式

```bash
python main.py --url https://github.com/用户名/仓库名
```

例如：
```bash
python main.py --url https://github.com/microsoft/vscode
```

#### 交互式方式

```bash
python main.py
```

程序启动后会进入交互式循环模式，显示欢迎信息和可用命令：
```
欢迎使用 GitHub 项目信息爬取工具！
- 输入 GitHub 仓库 URL 来爬取项目信息
- 输入 'refresh' 刷新所有已爬取的仓库信息
- 输入 'list' 查看已爬取的仓库列表
- 输入 'delete 仓库名称' 删除指定仓库的信息
- 输入 'exit' 退出程序
============================================================

请输入命令:
```

您可以直接输入 GitHub 仓库 URL 来爬取信息：
```
请输入命令: https://github.com/microsoft/vscode
```

### 2. 刷新所有已爬取的仓库信息

当您需要更新已爬取仓库的最新数据时（如最新的 Star 数量、Fork 数量等），可以使用刷新功能。

#### 命令行方式

```bash
python main.py --refresh
```

#### 交互式方式

在交互式循环模式下，输入 `refresh` 命令：
```
请输入命令: refresh
```

刷新过程会显示进度和结果：
```
开始刷新所有仓库信息 (共 3 个)...
[1/3] 正在刷新: vscode (https://github.com/microsoft/vscode)
  ✓ 成功更新: ⭐ 158423 | 🍴 28534 | ⚠️ 7832
[2/3] 正在刷新: tensorflow (https://github.com/tensorflow/tensorflow)
  ✓ 成功更新: ⭐ 178245 | 🍴 89632 | ⚠️ 2587
[3/3] 正在刷新: react (https://github.com/facebook/react)
  ✓ 成功更新: ⭐ 212378 | 🍴 45267 | ⚠️ 1256

刷新完成! 所有 3 个仓库都成功更新。
```

### 3. 查看已爬取的仓库列表

查看已爬取的所有仓库信息，包括仓库名称、URL、描述和统计数据，以及项目总数。

#### 命令行方式

```bash
python main.py --list
```

#### 交互式方式

在交互式循环模式下，输入 `list` 命令：
```
请输入命令: list
```

输出示例：
```
已爬取的 GitHub 仓库列表 (共 3 个):
------------------------------------------------------------
1. vscode - https://github.com/microsoft/vscode
   描述: Visual Studio Code
   统计: ⭐ 158423 | 🍴 28534 | ⚠️ 7832
------------------------------------------------------------
2. tensorflow - https://github.com/tensorflow/tensorflow
   描述: An Open Source Machine Learning Framework for Everyone
   统计: ⭐ 178245 | 🍴 89632 | ⚠️ 2587
------------------------------------------------------------
3. react - https://github.com/facebook/react
   描述: A declarative, efficient, and flexible JavaScript...
   统计: ⭐ 212378 | 🍴 45267 | ⚠️ 1256
------------------------------------------------------------
```

### 4. 删除指定仓库信息

当您想要从 Excel 文件中删除某个仓库的信息时，可以使用删除功能。

#### 交互式方式

在交互式循环模式下，输入 `delete` 命令后跟仓库名称：
```
请输入命令: delete vscode
```

程序会要求您确认删除操作：
```
确定要删除仓库 'vscode' 的信息吗？(y/n): 
```

输入 `y` 或 `yes` 确认删除：
```
确定要删除仓库 'vscode' 的信息吗？(y/n): y
成功删除仓库 'vscode' 的信息
```

如果仓库不存在或操作失败，会显示详细的错误信息和解决方法：
```
删除失败: 可能原因如下:
  1. 未找到名为 'vscode' 的仓库
  2. Excel 文件 'github项目.xlsx' 正在被其他程序（如 Microsoft Excel）打开
  3. 您没有文件的写入权限

解决方法:
  1. 检查仓库名称是否正确，可使用 'list' 命令查看所有仓库
  2. 关闭所有可能正在使用该 Excel 文件的程序
  3. 检查文件是否设置为只读，或尝试以管理员身份运行程序
```

### 5. 退出程序

要退出交互式循环模式，输入 `exit` 命令：
```
请输入命令: exit
感谢使用，再见！
```

### 6. 自定义输出文件

默认情况下，爬取的信息会保存到当前目录下的 `github项目.xlsx` 文件中。您可以使用 `--output` 参数指定其他文件名：

```bash
python main.py --url https://github.com/用户名/仓库名 --output 我的收藏.xlsx
```

## 数据说明

爬取并保存的数据包括：

| 字段 | 说明 |
| ---- | ---- |
| 仓库URL | GitHub 仓库的完整 URL |
| 仓库名称 | 仓库的名称 |
| 仓库描述 | 仓库的简短描述 |
| Star数量 | 仓库获得的 Star 数量 |
| Fork数量 | 仓库被 Fork 的次数 |
| Issue数量 | 仓库当前的 Issue 数量 |
| 项目简介/README内容 | 仓库 README 文件的内容（可能会被截断） |

## 交互式循环模式说明

交互式循环模式是程序的默认交互方式，它允许您连续执行多个操作而无需重新启动程序。在此模式下：

1. 程序启动时会显示欢迎信息和可用命令列表
2. 您可以输入以下任意命令：
   - GitHub 仓库 URL：爬取该仓库信息
   - `refresh`：刷新所有已爬取的仓库信息
   - `list`：显示已爬取的仓库列表
   - `delete 仓库名称`：删除指定仓库的信息
   - `exit`：退出程序
3. 每执行完一个命令后，程序会继续等待下一个命令
4. 输入无效命令或空白内容不会导致程序退出

这种模式特别适合以下场景：
- 需要连续爬取多个仓库
- 在爬取后想立即查看结果
- 爬取后想立即刷新某些仓库信息
- 需要管理和删除不再关注的仓库

## 常见错误与解决方法

### 1. 权限被拒绝（Permission Denied）

**错误信息**:
```
删除失败: 未找到名为 'xxx' 的仓库或发生错误
```
或日志中出现:
```
Permission denied: 'github项目.xlsx'
```

**可能原因**:
1. Excel 文件正在被其他程序打开（例如 Microsoft Excel）
2. 文件被设置为只读
3. 用户没有文件或目录的写入权限

**解决方法**:
1. 关闭所有可能打开了该 Excel 文件的程序
2. 右键点击文件，选择属性，确保未勾选"只读"
3. 以管理员身份运行命令提示符或 PowerShell，然后执行程序
4. 如果文件位于网络驱动器或云同步文件夹中，尝试将文件移动到本地目录

### 2. 网络连接问题

**错误信息**:
```
爬取仓库信息失败，请检查 URL 是否正确或网络连接是否正常
```

**可能原因**:
1. 网络连接不稳定
2. GitHub 网站暂时无法访问
3. 网络代理或防火墙阻止了连接

**解决方法**:
1. 检查网络连接是否正常
2. 确认是否可以通过浏览器访问 GitHub
3. 尝试关闭防火墙或更换网络环境
4. 如果您在使用代理，请确保代理设置正确

### 3. GitHub 速率限制

**错误信息**:
```
更新失败: 无法获取仓库最新信息，请检查网络连接
```

**可能原因**:
GitHub 对 API 访问有频率限制，过于频繁的请求可能会触发限制

**解决方法**:
1. 等待一段时间（通常几分钟到一小时）再尝试
2. 减少批量请求的频率，增加 `delay` 参数值
3. 使用 GitHub 账号登录可获得更高的请求限制（需要修改程序）